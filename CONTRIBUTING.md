This guide provides instructions on developing and testing changes to this project. 

# Running the automated tests

Use the following steps to install GDS as a standalone project and run the tests:

1. Create `gradle-local.properties` and set `mlUsername` and `mlPassword` to your admin or admin-like username and 
   password
2. Run `./gradlew -i mlDeploy loadTestData test`

## Inspecting logging of HTTP requests and responses

If you wish to see the HTTP request/response that each test sends/receives, set the following value in your 
`gradle-local.properties` file:

    logRequestAndResponse=true

Or include it on the command line when running tests:

    ./gradlew -i test -PlogRequestAndResponse=true

This is often helpful when running a single test so that you can see what the input and output is for a particular 
scenario. To run a single test, such as `PointQueries`, run the following (this adds the property to the command 
line, but you can also just add it to your `gradle-local.properties` file so you don't need to remember to add it 
each time):

    ./gradlew -i test --tests PointQueries -PlogRequestAndResponse=true

To run an individual test method, add a period and the method name to the test class name:

    ./gradlew -i test --tests PointQueries.testPointIntersects1 -PlogRequestAndResponse=true

To force tests to be run, include `cleanTest`, which will prevent Gradle from not running a test due to it not 
having changed:

    ./gradlew -i cleanTest test --tests PointQueries.testPointIntersects1 -PlogRequestAndResponse=true

# Manual testing

You can perform manual testing by following the instructions in the `examples/sample-project/README.md` file for 
deploying an application that depends on marklogic-geo-data-services. 

Before doing so, you'll first need to publish marklogic-geo-data-services locally. To do so, run the following command
from the root directory in this repository:

    ./gradlew publishToMavenLocal

This will put a copy of the marklogic-geo-data-services library in your local Maven repository (which defaults to 
`~/m2/repository`). This is required so that the sample project can depend on marklogic-geo-data-services via the 
[ml-gradle mlBundle Gradle configuration](https://github.com/marklogic-community/ml-gradle/wiki/Bundles).

You can deploy the sample-project under "examples/sample-project" - see the README.md file in that directory for 
instructions on doing so.


# Testing with MarkLogic Koop Provider

Clone the https://github.com/koopjs/koop-provider-marklogic repository, checkout the develop branch, and read the 
CONTRIBUTING.md file.


# Testing the documentation locally

The docs for this project are stored in the `./docs` directory as a set of Markdown files. These are published via
[GitHub Pages](https://docs.github.com/en/pages/getting-started-with-github-pages/about-github-pages) using the
configuration found under "Settings / Pages" in this repository.

You can build and test the docs locally by
[following these GitHub instructions](https://docs.github.com/en/pages/setting-up-a-github-pages-site-with-jekyll/testing-your-github-pages-site-locally-with-jekyll),
though you don't need to perform all of those steps since some of the files generated by doing so are already in the
`./docs` directory. You just need to do the following:

1. Install the latest Ruby (rbenv works well for this).
2. Install Jekyll.
3. Go to the docs directory - `cd ./docs` .
4. Run `bundle install` (this may not be necessary due to Gemfile.lock being in version control).
5. Run `bundle exec jekyll serve`.

You can then go to http://localhost:4000 to view the docs. 
